
close all
clear all

%% Urano
 Urano=[ 0.0600   0.1000   1.0000
  3.7400   0.1000   1.0000
  3.9400   0.2950   0.9500
  4.1400   0.3950   0.9300
  4.5400   0.4720   0.9100
  5.0400   0.5000   0.8580
  5.1000   0.5000   0.8560
 12.5600   0.5000   0.8500
 18.0000   0.5000   0.8500
 19.0000   0.6070   0.7870
 19.6000   0.6360   0.7700
 24.0000   0.6700   0.7500
 26.0000   0.6700   0.7500
 30        0.67     0.75 
 ];


 Urano1=[ 0.0600   0.1000   1.0000
  3.7400   0.1000   1.0000
  3.9400   0.2950   0.9500
  4.1400   0.3950   0.9300
  4.5400   0.4720   0.9100
  5.0400   0.5000   0.8580
  5.1000   0.5000   0.8560
  12.5600   0.5000   0.8500
  15.6600   0.5000   0.8500
 ];
%take offset
Urano1(:,1)=Urano1(:,1)-Urano1(1,1);
Urano1(:,2)=Urano1(:,2)-Urano1(1,2);
Urano1(:,3)=Urano1(:,3)-Urano1(1,3);
%lets interpole  :D
Ura_t=Urano1(1,1):0.2:Urano1(end,1);
betap_Ur=interp1(Urano1(:,1),Urano1(:,2),Ura_t);
li_Ur=interp1(Urano1(:,1),Urano1(:,3),Ura_t);


 Urano2=[
     
 
 18.0000   0.5000   0.8500
 19.0000   0.6070   0.7870
 19.6000   0.6360   0.7700
 24.0000   0.6700   0.7500
 26.0000   0.6700   0.7500
 30        0.67     0.75 
 ];
%take offset
Urano2(:,1)=Urano2(:,1)-Urano2(1,1);
Urano2(:,2)=Urano2(:,2)-Urano2(1,2);
Urano2(:,3)=Urano2(:,3)-Urano2(1,3);
%lets interpole  :D
Ura_t2=Urano2(1,1):0.2:Urano2(end,1);
betap_Ur2=interp1(Urano2(:,1),Urano2(:,2),Ura_t2);
li_Ur2=interp1(Urano2(:,1),Urano2(:,3),Ura_t2);

%% Miyata 

Miyata=[
  1.5000   0.1001   0.8479
  2.7000   0.1001   0.8496
  3.9000   0.1001   0.8500
  3.9050   0.1001   0.8500
  4.0000   0.1382   0.8501
  4.1000   0.1727   0.8501
  4.2000   0.2039   0.8502
  4.3000   0.2321   0.8502
  4.4000   0.2576   0.8503
  4.5000   0.2807   0.8503
  4.6000   0.3016   0.8504
  4.6050   0.3016   0.8504
  4.7000   0.3205   0.8504
  4.8000   0.3377   0.8505
  4.9000   0.3531   0.8505
  5.0000   0.3672   0.8506
  5.1000   0.3798   0.8506
  5.2000   0.3913   0.8507
  5.3000   0.4017   0.8508
  5.4000   0.4111   0.8508
  5.5000   0.4196   0.8509
  5.6000   0.4273   0.8509
  5.7000   0.4342   0.8510
  5.8000   0.4405   0.8510
  5.9000   0.4462   0.8511
  6.0000   0.4514   0.8511
  6.1000   0.4560   0.8512
  6.2000   0.4603   0.8512
  6.3000   0.4641   0.8513
  6.4000   0.4675   0.8513
  6.5000   0.4707   0.8514
  6.6000   0.4735   0.8514
  6.7000   0.4761   0.8515
  6.8000   0.4784   0.8516
  6.9000   0.4805   0.8516
  7.0000   0.4824   0.8517
  7.1000   0.4841   0.8517
  7.2000   0.4856   0.8518
  7.3000   0.4870   0.8518
  7.4000   0.4883   0.8519
  7.5000   0.4895   0.8519
  7.6000   0.4905   0.8520
  7.7000   0.4914   0.8520
  7.8000   0.4923   0.8521
  7.9000   0.4931   0.8521
  8.0000   0.4938   0.8522
  8.1000   0.4944   0.8523
  8.2000   0.4950   0.8523
  8.3000   0.4955   0.8524
  8.4000   0.4960   0.8524
  8.5000   0.4964   0.8525
  8.6000   0.4968   0.8525
  8.7000   0.4971   0.8526
  8.8000   0.4974   0.8526
  8.9000   0.4977   0.8527
  9.0000   0.4980   0.8527
  9.1000   0.4982   0.8528
  9.2000   0.4984   0.8528
  9.3000   0.4986   0.8529
  9.4000   0.4988   0.8529
  9.5000   0.4989   0.8530
 18.6000   0.5004   0.8497
 18.6050   0.5004   0.8497
 18.7000   0.5242   0.8480
 18.8000   0.5457   0.8464
 18.9000   0.5651   0.8447
 19.0000   0.5828   0.8430
 19.1000   0.5987   0.8414
 19.2000   0.6131   0.8397
 19.3000   0.6262   0.8380
 19.4000   0.6380   0.8363
 19.5000   0.6486   0.8347
 19.6000   0.6583   0.8330
 19.7000   0.6670   0.8313
 19.8000   0.6750   0.8297
 19.9000   0.6821   0.8280
 20.0000   0.6886   0.8263
 20.1000   0.6945   0.8247
 20.2000   0.6998   0.8230
 20.3000   0.7046   0.8213
 20.4000   0.7089   0.8196
 20.5000   0.7128   0.8180
 20.6000   0.7164   0.8163
 20.7000   0.7196   0.8146
 20.8000   0.7225   0.8130
 20.9000   0.7252   0.8113
 21.0000   0.7275   0.8096
 21.1000   0.7297   0.8079
 21.2000   0.7316   0.8063
 21.3000   0.7334   0.8046
 21.4000   0.7350   0.8029
 21.5000   0.7365   0.8013
 21.6000   0.7378   0.7996
 21.7000   0.7389   0.7979
 21.8000   0.7400   0.7963
 21.9000   0.7410   0.7946
 22.0000   0.7419   0.7929
 22.1000   0.7427   0.7912
 22.2000   0.7434   0.7896
 22.3000   0.7440   0.7879
 22.4000   0.7446   0.7862
 22.5000   0.7451   0.7846
 22.6000   0.7456   0.7829
 22.7000   0.7461   0.7812
 22.8000   0.7465   0.7796
 22.9000   0.7468   0.7779
 23.0000   0.7471   0.7762
 23.1000   0.7474   0.7745
 23.2000   0.7477   0.7729
 23.3000   0.7479   0.7712
 23.4000   0.7481   0.7695
 23.5000   0.7483   0.7679
 23.6000   0.7485   0.7662
 23.7000   0.7487   0.7645
 23.8000   0.7488   0.7629
 23.9000   0.7490   0.7612
 24.0000   0.7491   0.7595
 24.1000   0.7492   0.7578
 24.2000   0.7493   0.7562
 24.3000   0.7494   0.7545
 24.4000   0.7494   0.7528
 24.5000   0.7495   0.7512
 24.6000   0.7496   0.7495  
 30        0.7496   0.7495
];




Miyata1=[
  1.5000   0.1001   0.8479
  2.7000   0.1001   0.8496
  3.9000   0.1001   0.8500
  3.9050   0.1001   0.8500
  4.0000   0.1382   0.8501
  4.1000   0.1727   0.8501
  4.2000   0.2039   0.8502
  4.3000   0.2321   0.8502
  4.4000   0.2576   0.8503
  4.5000   0.2807   0.8503
  4.6000   0.3016   0.8504
  4.6050   0.3016   0.8504
  4.7000   0.3205   0.8504
  4.8000   0.3377   0.8505
  4.9000   0.3531   0.8505
  5.0000   0.3672   0.8506
  5.1000   0.3798   0.8506
  5.2000   0.3913   0.8507
  5.3000   0.4017   0.8508
  5.4000   0.4111   0.8508
  5.5000   0.4196   0.8509
  5.6000   0.4273   0.8509
  5.7000   0.4342   0.8510
  5.8000   0.4405   0.8510
  5.9000   0.4462   0.8511
  6.0000   0.4514   0.8511
  6.1000   0.4560   0.8512
  6.2000   0.4603   0.8512
  6.3000   0.4641   0.8513
  6.4000   0.4675   0.8513
  6.5000   0.4707   0.8514
  6.6000   0.4735   0.8514
  6.7000   0.4761   0.8515
  6.8000   0.4784   0.8516
  6.9000   0.4805   0.8516
  7.0000   0.4824   0.8517
  7.1000   0.4841   0.8517
  7.2000   0.4856   0.8518
  7.3000   0.4870   0.8518
  7.4000   0.4883   0.8519
  7.5000   0.4895   0.8519
  7.6000   0.4905   0.8520
  7.7000   0.4914   0.8520
  7.8000   0.4923   0.8521
  7.9000   0.4931   0.8521
  8.0000   0.4938   0.8522
  8.1000   0.4944   0.8523
  8.2000   0.4950   0.8523
  8.3000   0.4955   0.8524
  8.4000   0.4960   0.8524
  8.5000   0.4964   0.8525
  8.6000   0.4968   0.8525
  8.7000   0.4971   0.8526
  8.8000   0.4974   0.8526
  8.9000   0.4977   0.8527
  9.0000   0.4980   0.8527
  9.1000   0.4982   0.8528
  9.2000   0.4984   0.8528
  9.3000   0.4986   0.8529
  9.4000   0.4988   0.8529
  9.5000   0.4989   0.8530
  15.660   0.4989   0.8530
];

Miyata1(:,1)=Miyata1(:,1)-Miyata1(1,1);
Miyata1(:,2)=Miyata1(:,2)-Miyata1(1,2);
Miyata1(:,3)=Miyata1(:,3)-Miyata1(1,3);
%Interpolate
%lets interpole  :D
Miy_t=Miyata1(1,1):0.2:Miyata1(end,1);
betap_Miy=interp1(Miyata1(:,1),Miyata1(:,2),Miy_t);
li_Miy=interp1(Miyata1(:,1),Miyata1(:,3),Miy_t);


Miyata2=[
 16.000   0.4989   0.8530 
 18.6000   0.5004   0.8497
 18.6050   0.5004   0.8497
 18.7000   0.5242   0.8480
 18.8000   0.5457   0.8464
 18.9000   0.5651   0.8447
 19.0000   0.5828   0.8430
 19.1000   0.5987   0.8414
 19.2000   0.6131   0.8397
 19.3000   0.6262   0.8380
 19.4000   0.6380   0.8363
 19.5000   0.6486   0.8347
 19.6000   0.6583   0.8330
 19.7000   0.6670   0.8313
 19.8000   0.6750   0.8297
 19.9000   0.6821   0.8280
 20.0000   0.6886   0.8263
 20.1000   0.6945   0.8247
 20.2000   0.6998   0.8230
 20.3000   0.7046   0.8213
 20.4000   0.7089   0.8196
 20.5000   0.7128   0.8180
 20.6000   0.7164   0.8163
 20.7000   0.7196   0.8146
 20.8000   0.7225   0.8130
 20.9000   0.7252   0.8113
 21.0000   0.7275   0.8096
 21.1000   0.7297   0.8079
 21.2000   0.7316   0.8063
 21.3000   0.7334   0.8046
 21.4000   0.7350   0.8029
 21.5000   0.7365   0.8013
 21.6000   0.7378   0.7996
 21.7000   0.7389   0.7979
 21.8000   0.7400   0.7963
 21.9000   0.7410   0.7946
 22.0000   0.7419   0.7929
 22.1000   0.7427   0.7912
 22.2000   0.7434   0.7896
 22.3000   0.7440   0.7879
 22.4000   0.7446   0.7862
 22.5000   0.7451   0.7846
 22.6000   0.7456   0.7829
 22.7000   0.7461   0.7812
 22.8000   0.7465   0.7796
 22.9000   0.7468   0.7779
 23.0000   0.7471   0.7762
 23.1000   0.7474   0.7745
 23.2000   0.7477   0.7729
 23.3000   0.7479   0.7712
 23.4000   0.7481   0.7695
 23.5000   0.7483   0.7679
 23.6000   0.7485   0.7662
 23.7000   0.7487   0.7645
 23.8000   0.7488   0.7629
 23.9000   0.7490   0.7612
 24.0000   0.7491   0.7595
 24.1000   0.7492   0.7578
 24.2000   0.7493   0.7562
 24.3000   0.7494   0.7545
 24.4000   0.7494   0.7528
 24.5000   0.7495   0.7512
 24.6000   0.7496   0.7495  
 30        0.7496   0.7495    
];
Miyata2(:,2)=Miyata2(:,2)-Miyata2(1,2);
Miyata2(:,3)=Miyata2(:,3)-Miyata2(1,3);
Miyata2(:,1)=Miyata2(:,1)-Miyata2(1,1);

%Interpolate
%lets interpole  :D
Miy_t2=Miyata2(1,1):0.2:Miyata2(end,1);
betap_Miy2=interp1(Miyata2(:,1),Miyata2(:,2),Miy_t2);
li_Miy2=interp1(Miyata2(:,1),Miyata2(:,3),Miy_t2);




figure(1)

plot(Urano(:,1),Urano(:,2))
hold on
plot(Urano(:,1),Urano(:,3))
title('Urano')
grid on

figure(2)

plot(Miyata(:,1),Miyata(:,2))
hold on
plot(Miyata(:,1),Miyata(:,3))
title('Miyata')
grid on

figure(3)

plot(Urano1(:,1),Urano1(:,2))
hold on
plot(Urano1(:,1),Urano1(:,3))
plot(Urano2(:,1),Urano2(:,2))
hold on
plot(Urano2(:,1),Urano2(:,3))
title('Urano1 and 2')
grid on


figure(4)

plot(Miyata1(:,1),Miyata1(:,2))
hold on
plot(Miyata1(:,1),Miyata1(:,3))
plot(Miyata2(:,1),Miyata2(:,2))
hold on
plot(Miyata2(:,1),Miyata2(:,3))
title('Miyata 1 and 2')
grid on


%Ip changing while RU
%from Urano fig.13 Ip=1.51 MA t=3.74 s      Ip=5.5 MA  t=15 s
t1=0;
t2=11;
m=1e6*(1.42-5.5)/(t1-t2);
b=1.42e6-(m*t1);

Ip_Miy=m*(Miy_t)+b;
Ip_Ura=m*(Ura_t)+b;

for i=1:length(Ip_Miy)
if Ip_Miy(i) > 5.5e6
    Ip_Miy(i)=5.5e6;
end
end


for i=1:length(Ip_Ura)
if Ip_Ura(i) > 5.5e6
    Ip_Ura(i)=5.5e6;
end
end
return
% %% Saving
% save li_bp_IpRU Miy_t Ura_t betap_Ur betap_Miy li_Ur li_Miy Ip_Miy Ip_Ura
% save li_bp_IpRU2 Miy_t2 Ura_t2 betap_Ur2 betap_Miy2 li_Ur2 li_Miy2 
%% 
close all
figure(1)

plot(Urano(:,1),Urano(:,2),'LineWidth',2)
hold on
plot(Urano(:,1),Urano(:,3),'LineWidth',2)
tit=title('Urano');
leg=legend('\beta_p','\it li');
set(leg,'Fontsize',14)
set(tit,'Fontsize',16)
 set(gca,'FontSize',11);
xlabel('Time [s]')
grid on

figure(2)

plot(Miyata(:,1),Miyata(:,2),'LineWidth',2)
hold on
plot(Miyata(:,1),Miyata(:,3),'LineWidth',2)
tit=title('Miyata');
leg=legend('\beta_p','\it li');
set(leg,'Fontsize',14)
set(tit,'Fontsize',16)
 set(gca,'FontSize',11);
xlabel('Time [s]')
grid on

%% Subplot for SOFT papper
%%% For sevilla lets put they happend at t=20[s] cuz SOF starts at 18.66[s]
figure(3)
tit=suptitle('Disturbance #1');
subplot(2,1,2)
plot(Urano(:,1)+2,Urano(:,2),'LineWidth',2)
leg=legend('\beta_p');
xlim([14 29])
grid on
 set(gca,'FontSize',11);
xlabel('Time [s]')

subplot(2,1,1)
plot(Urano(:,1)+2,Urano(:,3),'LineWidth',2)

xlim([14 29])
leg1=legend('\it li');
set(leg,'Fontsize',14)
set(leg1,'Fontsize',14)
set(tit,'Fontsize',16)

grid on